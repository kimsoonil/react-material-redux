{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkToIE = exports.getLogger = exports.getScopes = exports.getUserAgentApp = void 0;\n\nvar msal_1 = require(\"msal\");\n\nvar CLIENT_ID_REGEX = /[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/;\n\nvar getUserAgentApp = function (_a) {\n  var clientId = _a.clientId,\n      tenantUrl = _a.tenantUrl,\n      redirectUri = _a.redirectUri;\n\n  if (clientId && CLIENT_ID_REGEX.test(clientId)) {\n    return new msal_1.UserAgentApplication({\n      auth: __assign(__assign(__assign({}, redirectUri && {\n        redirectUri: redirectUri\n      }), tenantUrl && {\n        authority: tenantUrl\n      }), {\n        clientId: clientId,\n        validateAuthority: true,\n        navigateToLoginRequestUrl: false\n      })\n    });\n  }\n};\n\nexports.getUserAgentApp = getUserAgentApp;\n\nvar getScopes = function (graphScopes) {\n  var scopes = graphScopes || [];\n\n  if (!scopes.find(function (el) {\n    return el.toLowerCase() === \"user.read\";\n  })) {\n    scopes.push(\"user.read\");\n  }\n\n  return scopes;\n};\n\nexports.getScopes = getScopes;\n\nvar getLogger = function (isDebugMode) {\n  return function (name, content, isError) {\n    if (isDebugMode) {\n      var style = \"background-color: \" + (isError ? \"#990000\" : \"#009900\") + \"; color: #ffffff; font-weight: 700; padding: 2px\";\n      console.groupCollapsed(\"MSLogin debug\");\n      console.log(\"%c\" + name, style);\n      content && console.log(content.message || content);\n      console.groupEnd();\n    }\n  };\n};\n\nexports.getLogger = getLogger;\n\nvar checkToIE = function () {\n  var ua = window.navigator.userAgent;\n  var msie = ua.indexOf(\"MSIE \");\n  var msie11 = ua.indexOf(\"Trident/\");\n  var msedge = ua.indexOf(\"Edge/\");\n  var isIE = msie > 0 || msie11 > 0;\n  var isEdge = msedge > 0;\n  return isIE || isEdge;\n};\n\nexports.checkToIE = checkToIE;","map":{"version":3,"sources":["../src/helpers.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,MAAA,GAAA,OAAA,CAAA,MAAA,CAAA;;AAEA,IAAM,eAAe,GAAG,8DAAxB;;AAEO,IAAM,eAAe,GAAG,UAAC,EAAD,EAQ9B;MAPC,QAAQ,GAAA,EAAA,CAAA,Q;MACR,SAAS,GAAA,EAAA,CAAA,S;MACT,WAAW,GAAA,EAAA,CAAA,W;;AAMX,MAAI,QAAQ,IAAI,eAAe,CAAC,IAAhB,CAAqB,QAArB,CAAhB,EAAgD;AAC9C,WAAO,IAAI,MAAA,CAAA,oBAAJ,CAAyB;AAC9B,MAAA,IAAI,EAAA,QAAA,CAAA,QAAA,CAAA,QAAA,CAAA,EAAA,EACE,WAAW,IAAI;AAAE,QAAA,WAAW,EAAA;AAAb,OADjB,CAAA,EAEE,SAAS,IAAI;AAAE,QAAA,SAAS,EAAE;AAAb,OAFf,CAAA,EAEwC;AAC1C,QAAA,QAAQ,EAAA,QADkC;AAE1C,QAAA,iBAAiB,EAAE,IAFuB;AAG1C,QAAA,yBAAyB,EAAE;AAHe,OAFxC;AAD0B,KAAzB,CAAP;AASD;AACF,CApBM;;AAAM,OAAA,CAAA,eAAA,GAAe,eAAf;;AAsBN,IAAM,SAAS,GAAG,UAAC,WAAD,EAAuB;AAC9C,MAAM,MAAM,GAAG,WAAW,IAAI,EAA9B;;AACA,MAAI,CAAC,MAAM,CAAC,IAAP,CAAY,UAAC,EAAD,EAAW;AAAK,WAAA,EAAE,CAAC,WAAH,OAAA,WAAA;AAAgC,GAA5D,CAAL,EAAoE;AAClE,IAAA,MAAM,CAAC,IAAP,CAAY,WAAZ;AACD;;AACD,SAAO,MAAP;AACD,CANM;;AAAM,OAAA,CAAA,SAAA,GAAS,SAAT;;AAQN,IAAM,SAAS,GAAG,UAAC,WAAD,EAAsB;AAAK,SAAA,UAClD,IADkD,EAElD,OAFkD,EAGlD,OAHkD,EAGjC;AAEjB,QAAI,WAAJ,EAAiB;AACf,UAAM,KAAK,GAAG,wBACZ,OAAO,GAAG,SAAH,GAAe,SADV,IACmB,kDADjC;AAGA,MAAA,OAAO,CAAC,cAAR,CAAuB,eAAvB;AACA,MAAA,OAAO,CAAC,GAAR,CAAY,OAAK,IAAjB,EAAyB,KAAzB;AACA,MAAA,OAAO,IAAI,OAAO,CAAC,GAAR,CAAY,OAAO,CAAC,OAAR,IAAmB,OAA/B,CAAX;AACA,MAAA,OAAO,CAAC,QAAR;AACD;AAbiD,GAAA;AAcnD,CAdM;;AAAM,OAAA,CAAA,SAAA,GAAS,SAAT;;AAgBN,IAAM,SAAS,GAAG,YAAA;AACvB,MAAM,EAAE,GAAG,MAAM,CAAC,SAAP,CAAiB,SAA5B;AACA,MAAM,IAAI,GAAG,EAAE,CAAC,OAAH,CAAW,OAAX,CAAb;AACA,MAAM,MAAM,GAAG,EAAE,CAAC,OAAH,CAAW,UAAX,CAAf;AACA,MAAM,MAAM,GAAG,EAAE,CAAC,OAAH,CAAW,OAAX,CAAf;AACA,MAAM,IAAI,GAAG,IAAI,GAAG,CAAP,IAAY,MAAM,GAAG,CAAlC;AACA,MAAM,MAAM,GAAG,MAAM,GAAG,CAAxB;AACA,SAAO,IAAI,IAAI,MAAf;AACD,CARM;;AAAM,OAAA,CAAA,SAAA,GAAS,SAAT","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.checkToIE = exports.getLogger = exports.getScopes = exports.getUserAgentApp = void 0;\nvar msal_1 = require(\"msal\");\nvar CLIENT_ID_REGEX = /[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/;\nvar getUserAgentApp = function (_a) {\n    var clientId = _a.clientId, tenantUrl = _a.tenantUrl, redirectUri = _a.redirectUri;\n    if (clientId && CLIENT_ID_REGEX.test(clientId)) {\n        return new msal_1.UserAgentApplication({\n            auth: __assign(__assign(__assign({}, (redirectUri && { redirectUri: redirectUri })), (tenantUrl && { authority: tenantUrl })), { clientId: clientId, validateAuthority: true, navigateToLoginRequestUrl: false }),\n        });\n    }\n};\nexports.getUserAgentApp = getUserAgentApp;\nvar getScopes = function (graphScopes) {\n    var scopes = graphScopes || [];\n    if (!scopes.find(function (el) { return el.toLowerCase() === \"user.read\"; })) {\n        scopes.push(\"user.read\");\n    }\n    return scopes;\n};\nexports.getScopes = getScopes;\nvar getLogger = function (isDebugMode) { return function (name, content, isError) {\n    if (isDebugMode) {\n        var style = \"background-color: \" + (isError ? \"#990000\" : \"#009900\") + \"; color: #ffffff; font-weight: 700; padding: 2px\";\n        console.groupCollapsed(\"MSLogin debug\");\n        console.log(\"%c\" + name, style);\n        content && console.log(content.message || content);\n        console.groupEnd();\n    }\n}; };\nexports.getLogger = getLogger;\nvar checkToIE = function () {\n    var ua = window.navigator.userAgent;\n    var msie = ua.indexOf(\"MSIE \");\n    var msie11 = ua.indexOf(\"Trident/\");\n    var msedge = ua.indexOf(\"Edge/\");\n    var isIE = msie > 0 || msie11 > 0;\n    var isEdge = msedge > 0;\n    return isIE || isEdge;\n};\nexports.checkToIE = checkToIE;\n//# sourceMappingURL=helpers.js.map"]},"metadata":{},"sourceType":"script"}