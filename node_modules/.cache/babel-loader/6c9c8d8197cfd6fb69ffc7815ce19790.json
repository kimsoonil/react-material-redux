{"ast":null,"code":"/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\nimport * as tslib_1 from \"tslib\";\nimport { ResponseTypes, ServerHashParamKeys } from \"./Constants\";\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * @hidden\r\n */\n\nvar ResponseUtils =\n/** @class */\nfunction () {\n  function ResponseUtils() {}\n\n  ResponseUtils.setResponseIdToken = function (originalResponse, idTokenObj) {\n    if (!originalResponse) {\n      return null;\n    } else if (!idTokenObj) {\n      return originalResponse;\n    }\n\n    var exp = Number(idTokenObj.expiration);\n\n    if (exp && !originalResponse.expiresOn) {\n      originalResponse.expiresOn = new Date(exp * 1000);\n    }\n\n    return tslib_1.__assign({}, originalResponse, {\n      idToken: idTokenObj,\n      idTokenClaims: idTokenObj.claims,\n      uniqueId: idTokenObj.objectId || idTokenObj.subject,\n      tenantId: idTokenObj.tenantId\n    });\n  };\n\n  ResponseUtils.buildAuthResponse = function (idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState) {\n    switch (serverAuthenticationRequest.responseType) {\n      case ResponseTypes.id_token:\n        authResponse = tslib_1.__assign({}, authResponse, {\n          tokenType: ServerHashParamKeys.ID_TOKEN,\n          account: account,\n          scopes: scopes,\n          accountState: accountState\n        });\n        authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);\n        return authResponse.idToken ? authResponse : null;\n\n      case ResponseTypes.id_token_token:\n        authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);\n        return authResponse && authResponse.accessToken && authResponse.idToken ? authResponse : null;\n\n      case ResponseTypes.token:\n        authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);\n        return authResponse;\n\n      default:\n        return null;\n    }\n  };\n\n  return ResponseUtils;\n}();\n\nexport { ResponseUtils };","map":{"version":3,"sources":["../../src/utils/ResponseUtils.ts"],"names":[],"mappings":"AAAA;;;AAGG;;AAKH,SAAS,aAAT,EAAwB,mBAAxB,QAAmD,aAAnD;AAGA;;;AAGG;;AAEH;;AAEG;;AACH,IAAA,aAAA;AAAA;AAAA,YAAA;AAAA,WAAA,aAAA,GAAA,CA8CC;;AA5CU,EAAA,aAAA,CAAA,kBAAA,GAAP,UAA0B,gBAA1B,EAA0D,UAA1D,EAA6E;AACzE,QAAI,CAAC,gBAAL,EAAuB;AACnB,aAAO,IAAP;AACH,KAFD,MAEO,IAAI,CAAC,UAAL,EAAiB;AACpB,aAAO,gBAAP;AACH;;AAED,QAAM,GAAG,GAAG,MAAM,CAAC,UAAU,CAAC,UAAZ,CAAlB;;AACA,QAAI,GAAG,IAAI,CAAC,gBAAgB,CAAC,SAA7B,EAAwC;AACpC,MAAA,gBAAgB,CAAC,SAAjB,GAA6B,IAAI,IAAJ,CAAS,GAAG,GAAG,IAAf,CAA7B;AACH;;AAED,WAAA,OAAA,CAAA,QAAA,CAAA,EAAA,EACO,gBADP,EACuB;AACnB,MAAA,OAAO,EAAE,UADU;AAEnB,MAAA,aAAa,EAAE,UAAU,CAAC,MAFP;AAGnB,MAAA,QAAQ,EAAE,UAAU,CAAC,QAAX,IAAuB,UAAU,CAAC,OAHzB;AAInB,MAAA,QAAQ,EAAE,UAAU,CAAC;AAJF,KADvB,CAAA;AAOH,GAnBM;;AAqBA,EAAA,aAAA,CAAA,iBAAA,GAAP,UAAyB,OAAzB,EAA2C,YAA3C,EAAuE,2BAAvE,EAA6H,OAA7H,EAA+I,MAA/I,EAAsK,YAAtK,EAA0L;AACtL,YAAO,2BAA2B,CAAC,YAAnC;AACI,WAAK,aAAa,CAAC,QAAnB;AACI,QAAA,YAAY,GAAA,OAAA,CAAA,QAAA,CAAA,EAAA,EACL,YADK,EACO;AACf,UAAA,SAAS,EAAE,mBAAmB,CAAC,QADhB;AAEf,UAAA,OAAO,EAAE,OAFM;AAGf,UAAA,MAAM,EAAE,MAHO;AAIf,UAAA,YAAY,EAAE;AAJC,SADP,CAAZ;AAQA,QAAA,YAAY,GAAG,aAAa,CAAC,kBAAd,CAAiC,YAAjC,EAA+C,OAA/C,CAAf;AACA,eAAQ,YAAY,CAAC,OAAd,GAAyB,YAAzB,GAAwC,IAA/C;;AACJ,WAAK,aAAa,CAAC,cAAnB;AACI,QAAA,YAAY,GAAG,aAAa,CAAC,kBAAd,CAAiC,YAAjC,EAA+C,OAA/C,CAAf;AACA,eAAQ,YAAY,IAAI,YAAY,CAAC,WAA7B,IAA4C,YAAY,CAAC,OAA1D,GAAqE,YAArE,GAAoF,IAA3F;;AACJ,WAAK,aAAa,CAAC,KAAnB;AACI,QAAA,YAAY,GAAG,aAAa,CAAC,kBAAd,CAAiC,YAAjC,EAA+C,OAA/C,CAAf;AACA,eAAO,YAAP;;AACJ;AACI,eAAO,IAAP;AAnBR;AAqBH,GAtBM;;AAuBX,SAAA,aAAA;AAAC,CA9CD,EAAA","sourceRoot":"","sourcesContent":["/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\nimport * as tslib_1 from \"tslib\";\r\nimport { ResponseTypes, ServerHashParamKeys } from \"./Constants\";\r\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n/**\r\n * @hidden\r\n */\r\nvar ResponseUtils = /** @class */ (function () {\r\n    function ResponseUtils() {\r\n    }\r\n    ResponseUtils.setResponseIdToken = function (originalResponse, idTokenObj) {\r\n        if (!originalResponse) {\r\n            return null;\r\n        }\r\n        else if (!idTokenObj) {\r\n            return originalResponse;\r\n        }\r\n        var exp = Number(idTokenObj.expiration);\r\n        if (exp && !originalResponse.expiresOn) {\r\n            originalResponse.expiresOn = new Date(exp * 1000);\r\n        }\r\n        return tslib_1.__assign({}, originalResponse, { idToken: idTokenObj, idTokenClaims: idTokenObj.claims, uniqueId: idTokenObj.objectId || idTokenObj.subject, tenantId: idTokenObj.tenantId });\r\n    };\r\n    ResponseUtils.buildAuthResponse = function (idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState) {\r\n        switch (serverAuthenticationRequest.responseType) {\r\n            case ResponseTypes.id_token:\r\n                authResponse = tslib_1.__assign({}, authResponse, { tokenType: ServerHashParamKeys.ID_TOKEN, account: account, scopes: scopes, accountState: accountState });\r\n                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);\r\n                return (authResponse.idToken) ? authResponse : null;\r\n            case ResponseTypes.id_token_token:\r\n                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);\r\n                return (authResponse && authResponse.accessToken && authResponse.idToken) ? authResponse : null;\r\n            case ResponseTypes.token:\r\n                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);\r\n                return authResponse;\r\n            default:\r\n                return null;\r\n        }\r\n    };\r\n    return ResponseUtils;\r\n}());\r\nexport { ResponseUtils };\r\n//# sourceMappingURL=ResponseUtils.js.map"]},"metadata":{},"sourceType":"module"}